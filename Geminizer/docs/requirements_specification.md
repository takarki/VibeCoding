# 要求仕様書 (Requirements Specification)

## 1. プロジェクト概要
**名称**: Gemini YouTube Summary Extension (仮)
**目的**: ブラウザで閲覧中のページ（特にYouTube）のURLとコンテンツ情報を取得し、ユーザーが選択したプロンプトに基づいてAI（Gemini等）で要約やコンテンツ生成を行うChrome拡張機能を開発する。

## 2. 背景・課題
- YouTube動画の内容を効率的に把握したい。
- 動画内の特定のトピックについて、該当する時間へのリンク付きで要約が欲しい。
- Webページの内容を元に、要約だけでなく、インフォグラフィック作成、図解作成、ポッドキャスト台本作成など、多目的に活用したい。
- 毎回プロンプトをコピー＆ペーストするのが手間である。

## 3. 主な機能要件

### 3.1. 基本フロー
1. ユーザーがChrome拡張のアイコンをクリックする。
2. ポップアップ画面が表示される。
3. ユーザーがあらかじめ登録された「プロンプトテンプレート」を選択する。
4. 「実行」ボタンを押すと、以下の動作を行う：
    - 現在のタブのURLを取得。
    - （オプション）ページ内のテキストや字幕情報を取得（技術的実現性による）。
    - 新しいタブでAIサービス（Gemini等）を開く。
    - 取得したURL/コンテンツと選択したプロンプトを組み合わせたテキストを、AIの入力欄に自動入力（またはクリップボードにコピーしてペーストを促す、あるいはAPI経由で送信）。

### 3.2. 対象プラットフォーム
- **初期**: Google Gemini
- **将来**: ChatGPT, Claude, Grok, Monica 等へ拡張可能にする。

### 3.3. プロンプト管理
- ユーザーが自由にプロンプトを追加・編集・削除できる機能。
- プロンプトには変数を埋め込める（例: `{{url}}`, `{{content}}`）。

### 3.4. 特定ユースケース
- **YouTube要約**:
    - 動画の要約を生成。
    - 重要なポイントにタイムスタンプリンク（例: 10:05）を含める。
    - リンクをクリックすると、その時間の動画再生位置にジャンプする。
- **コンテンツ変換**:
    - HTMLインフォグラフィック用構成案の作成。
    - NanoBanana Pro用図解データの作成。
    - ポッドキャスト用台本の作成。

## 4. 非機能要件
- **拡張性**: 新しいAIサービスやプロンプトを容易に追加できるアーキテクチャ。
- **使いやすさ**: 2クリック以内で主要なアクション（要約生成）が開始できること。

---

## 5. 提案・確認事項 (Proposals & Questions)

### 5.1. AIとの連携方法について
**現状の提案**:
Gemini等のWebインターフェースを新しいタブで開き、プロンプトを自動挿入する方式（Script Injection）を想定しています。
- **メリット**: APIキーが不要で無料版でも利用しやすい。ユーザーが普段使っている環境をそのまま使える。
- **デメリット**: サイトの仕様変更で動かなくなるリスクがある。自動投稿が難しい場合がある（ペーストまで行い、送信はユーザーが押す等）。
- **代替案**: 各AIのAPIを利用する。安定性は高いが、ユーザーにAPIキーを取得してもらう必要があり、コストが発生する場合がある。
**→ 推奨**: まずは「Webインターフェース連携（URLパラメータやScript Injection）」で実装し、将来的にAPIモードも選べるように設計します。

### 5.2. YouTubeのタイムスタンプリンクについて
Geminiが生成するテキスト内のタイムスタンプ（例: "05:30"）は、そのままではクリック可能なリンクにならない場合があります。
**提案**:
拡張機能側でGeminiの回答画面を監視し、タイムスタンプ形式のテキスト（"mm:ss"）を検出して、元のYouTube動画へのリンク（`youtube.com/watch?v=ID&t=330s`）に変換するスクリプトを注入する機能を検討します。

### 5.3. コンテンツの取得範囲
URLを渡すだけでGeminiが内容を読み取れる場合（YouTube等）はそのままで良いですが、ログインが必要なページやGeminiがアクセスできないページの場合、拡張機能がページ内のテキストを抽出してプロンプトに含める必要があります。
**提案**:
プロンプト設定で「URLのみ渡す」か「ページ本文も抽出して渡す」かを選択できるようにします。

### 5.4. NanoBanana Pro連携
「NanoBanana Pro」の詳細な入力フォーマット（JSON, Markdown, 専用テキスト形式など）に合わせてプロンプトを調整する必要があります。これ用のプリセットプロンプトを用意します。
